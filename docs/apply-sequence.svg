<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="645px" preserveAspectRatio="none" style="width:659px;height:645px;" version="1.1" viewBox="0 0 659 645" width="659px" zoomAndPan="magnify"><defs><filter height="300%" id="f1p5nxq36ea7ut" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="335" x="160" y="28.708">Binary Delta Patcher Apply Command</text><rect fill="#FFFFFF" filter="url(#f1p5nxq36ea7ut)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="278" x="367" y="271.0469"/><rect fill="#FFFFFF" filter="url(#f1p5nxq36ea7ut)" height="162.7969" style="stroke:#000000;stroke-width:2.0;" width="488" x="92" y="331.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="48" x2="48" y1="79.25" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="126" x2="126" y1="79.25" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="236.5" x2="236.5" y1="79.25" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="298.5" x2="298.5" y1="79.25" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="434" x2="434" y1="79.25" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="536" x2="536" y1="79.25" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="607" x2="607" y1="79.25" y2="598.5078"/><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="83" x="5" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="12" y="63.9482">PatchTool</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="83" x="5" y="597.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="12" y="617.5029">PatchTool</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="45" x="102" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="109" y="63.9482">[src]</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="45" x="102" y="597.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="109" y="617.5029">[src]</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="211.5" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="218.5" y="63.9482">[dst]</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="211.5" y="597.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="218.5" y="617.5029">[dst]</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="50" x="271.5" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="278.5" y="63.9482">[pch]</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="50" x="271.5" y="597.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="278.5" y="617.5029">[pch]</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="107" x="381" y="39.9531"/><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="107" x="377" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="384" y="63.9482">XDelta3Patch</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="107" x="381" y="597.5078"/><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="107" x="377" y="601.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="384" y="621.5029">XDelta3Patch</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="64" x="502" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="509" y="63.9482">xdelta3</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="64" x="502" y="597.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="509" y="617.5029">xdelta3</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="51" x="580" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="587" y="63.9482">HTTP</text><rect fill="#FEFECE" filter="url(#f1p5nxq36ea7ut)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="51" x="580" y="597.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="587" y="617.5029">HTTP</text><polygon fill="#FF6655" points="59.5,106.3828,49.5,110.3828,59.5,114.3828,55.5,110.3828" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="286.5,106.3828,296.5,110.3828,286.5,114.3828,290.5,110.3828" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="53.5" x2="292.5" y1="110.3828" y2="110.3828"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="65.5" y="105.3169">read manifest</text><polygon fill="#FF6655" points="224.5,135.5156,234.5,139.5156,224.5,143.5156,228.5,139.5156" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="48.5" x2="230.5" y1="139.5156" y2="139.5156"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="55.5" y="134.4497">create directory structure</text><polygon fill="#FF6655" points="422.5,164.6484,432.5,168.6484,422.5,172.6484,426.5,168.6484" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="48.5" x2="428.5" y1="168.6484" y2="168.6484"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="55.5" y="163.5825">apply delta files</text><polygon fill="#FF6655" points="247.5,193.7813,237.5,197.7813,247.5,201.7813,243.5,197.7813" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="422.5,193.7813,432.5,197.7813,422.5,201.7813,426.5,197.7813" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="241.5" x2="428.5" y1="197.7813" y2="197.7813"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="253.5" y="192.7153">validate dst hash</text><polygon fill="#FF6655" points="137.5,222.9141,127.5,226.9141,137.5,230.9141,133.5,226.9141" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="422.5,222.9141,432.5,226.9141,422.5,230.9141,426.5,226.9141" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="131.5" x2="428.5" y1="226.9141" y2="226.9141"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="143.5" y="221.8481">validate src hash</text><polygon fill="#FF6655" points="309.5,252.0469,299.5,256.0469,309.5,260.0469,305.5,256.0469" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="422.5,252.0469,432.5,256.0469,422.5,260.0469,426.5,256.0469" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="303.5" x2="428.5" y1="256.0469" y2="256.0469"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="315.5" y="250.981">validate pch hash</text><path d="M367,271.0469 L591,271.0469 L591,278.0469 L581,288.0469 L367,288.0469 L367,271.0469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="278" x="367" y="271.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="179" x="382" y="284.1138">if hash validation failure</text><polygon fill="#FF6655" points="445.5,305.3125,435.5,309.3125,445.5,313.3125,441.5,309.3125" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="595.5,305.3125,605.5,309.3125,595.5,313.3125,599.5,309.3125" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="439.5" x2="601.5" y1="309.3125" y2="309.3125"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="451.5" y="304.2466">download dst file(s)</text><path d="M92,331.3125 L327,331.3125 L327,338.3125 L317,348.3125 L92,348.3125 L92,331.3125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="162.7969" style="stroke:#000000;stroke-width:2.0;" width="488" x="92" y="331.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="190" x="107" y="344.3794">if hash validation success</text><polygon fill="#FF6655" points="524,365.5781,534,369.5781,524,373.5781,528,369.5781" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="434.5" x2="530" y1="369.5781" y2="369.5781"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="441.5" y="364.5122">apply diff</text><polygon fill="#FF6655" points="137.5,394.7109,127.5,398.7109,137.5,402.7109,133.5,398.7109" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="524,394.7109,534,398.7109,524,402.7109,528,398.7109" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="131.5" x2="530" y1="398.7109" y2="398.7109"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="143.5" y="393.645">read file</text><polygon fill="#FF6655" points="309.5,423.8438,299.5,427.8438,309.5,431.8438,305.5,427.8438" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="524,423.8438,534,427.8438,524,431.8438,528,427.8438" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="303.5" x2="530" y1="427.8438" y2="427.8438"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="315.5" y="422.7778">read file</text><polygon fill="#FF6655" points="247.5,452.9766,237.5,456.9766,247.5,460.9766,243.5,456.9766" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="524,452.9766,534,456.9766,524,460.9766,528,456.9766" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="241.5" x2="530" y1="456.9766" y2="456.9766"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="253.5" y="451.9106">read file</text><polygon fill="#FF6655" points="247.5,482.1094,237.5,486.1094,247.5,490.1094,243.5,486.1094" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="524,482.1094,534,486.1094,524,490.1094,528,486.1094" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="241.5" x2="530" y1="486.1094" y2="486.1094"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="253.5" y="481.0435">write file</text><polygon fill="#FF6655" points="59.5,518.2422,49.5,522.2422,59.5,526.2422,55.5,522.2422" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="53.5" x2="433.5" y1="522.2422" y2="522.2422"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="65.5" y="517.1763">return src/dst/pch hashes</text><polygon fill="#FF6655" points="224.5,547.375,234.5,551.375,224.5,555.375,228.5,551.375" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="48.5" x2="230.5" y1="551.375" y2="551.375"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="55.5" y="546.3091">remove obsolete files/dirs</text><polygon fill="#FF6655" points="224.5,576.5078,234.5,580.5078,224.5,584.5078,228.5,580.5078" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="48.5" x2="230.5" y1="580.5078" y2="580.5078"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="55.5" y="575.4419">apply file properties</text><!--MD5=[dc63329263d80ff5e55973286f65777d]
@startuml apply-sequence

!include patchtool.iuml

title Binary Delta Patcher Apply Command

' initialize
PatchTool <-> pch : read manifest
PatchTool -> dst : create directory structure

' apply delta files
PatchTool -> XDelta3Patch : apply delta files
XDelta3Patch <-> dst : validate dst hash
XDelta3Patch <-> src : validate src hash
XDelta3Patch <-> pch : validate pch hash
group if hash validation failure
  XDelta3Patch <-> HTTP : download dst file(s)
end
group if hash validation success
  XDelta3Patch -> xdelta3 : apply diff
  xdelta3 <-> src : read file
  xdelta3 <-> pch : read file
  xdelta3 <-> dst : read file
  xdelta3 <-> dst : write file
end
XDelta3Patch -> PatchTool : return src/dst/pch hashes

' removed files
PatchTool -> dst : remove obsolete files/dirs
PatchTool -> dst : apply file properties

@enduml

@startuml apply-sequence

skinparam interface {
  backgroundColor white
  borderColor orange
}

skinparam component {
  FontSize 13
  FontName Courier
  BorderColor black
  BackgroundColor gold
  ArrowFontName Impact
  ArrowColor #FF6655
  ArrowFontColor #777777
}

participant PatchTool as PatchTool
participant "[src]" as src
participant "[dst]" as dst
participant "[pch]" as pch

collections XDelta3Patch as XDelta3Patch

participant "xdelta3" as xdelta3
participant "HTTP" as HTTP

title Binary Delta Patcher Apply Command

PatchTool <-> pch : read manifest
PatchTool -> dst : create directory structure

PatchTool -> XDelta3Patch : apply delta files
XDelta3Patch <-> dst : validate dst hash
XDelta3Patch <-> src : validate src hash
XDelta3Patch <-> pch : validate pch hash
group if hash validation failure
  XDelta3Patch <-> HTTP : download dst file(s)
end
group if hash validation success
  XDelta3Patch -> xdelta3 : apply diff
  xdelta3 <-> src : read file
  xdelta3 <-> pch : read file
  xdelta3 <-> dst : read file
  xdelta3 <-> dst : write file
end
XDelta3Patch -> PatchTool : return src/dst/pch hashes

PatchTool -> dst : remove obsolete files/dirs
PatchTool -> dst : apply file properties

@enduml

PlantUML version 1.2020.22(Sun Dec 06 04:36:27 EST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>