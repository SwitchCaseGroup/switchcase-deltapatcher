<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="641px" preserveAspectRatio="none" style="width:540px;height:641px;" version="1.1" viewBox="0 0 540 641" width="540px" zoomAndPan="magnify"><defs><filter height="300%" id="f121m8jbry157x" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="368" x="83.75" y="28.708">Binary Delta Patcher Generate Command</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="48" x2="48" y1="79.25" y2="594.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="175" x2="175" y1="79.25" y2="594.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="235" x2="235" y1="79.25" y2="594.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="297" x2="297" y1="79.25" y2="594.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="391" x2="391" y1="79.25" y2="594.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="496.5" x2="496.5" y1="79.25" y2="594.5078"/><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="83" x="5" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="12" y="63.9482">PatchTool</text><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="83" x="5" y="593.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="12" y="613.5029">PatchTool</text><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="45" x="151" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="158" y="63.9482">[src]</text><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="45" x="151" y="593.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="158" y="613.5029">[src]</text><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="210" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="217" y="63.9482">[dst]</text><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="210" y="593.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="217" y="613.5029">[dst]</text><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="50" x="270" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="277" y="63.9482">[pch]</text><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="50" x="270" y="593.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="277" y="613.5029">[pch]</text><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="107" x="338" y="39.9531"/><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="107" x="334" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="341" y="63.9482">XDelta3Patch</text><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="107" x="338" y="593.5078"/><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="107" x="334" y="597.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="341" y="617.5029">XDelta3Patch</text><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="64" x="462.5" y="43.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="469.5" y="63.9482">xdelta3</text><rect fill="#FEFECE" filter="url(#f121m8jbry157x)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="64" x="462.5" y="593.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="469.5" y="613.5029">xdelta3</text><polygon fill="#FF6655" points="285,106.3828,295,110.3828,285,114.3828,289,110.3828" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="48.5" x2="291" y1="110.3828" y2="110.3828"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="55.5" y="105.3169">remove all files</text><polygon fill="#FF6655" points="59.5,135.5156,49.5,139.5156,59.5,143.5156,55.5,139.5156" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="163.5,135.5156,173.5,139.5156,163.5,143.5156,167.5,139.5156" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="53.5" x2="169.5" y1="139.5156" y2="139.5156"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="65.5" y="134.4497">parse metadata</text><polygon fill="#FF6655" points="59.5,164.6484,49.5,168.6484,59.5,172.6484,55.5,168.6484" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="223,164.6484,233,168.6484,223,172.6484,227,168.6484" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="53.5" x2="229" y1="168.6484" y2="168.6484"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="65.5" y="163.5825">parse metadata</text><polygon fill="#FF6655" points="285,193.7813,295,197.7813,285,201.7813,289,197.7813" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="48.5" x2="291" y1="197.7813" y2="197.7813"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="55.5" y="192.7153">create directory structure</text><polygon fill="#FF6655" points="379.5,222.9141,389.5,226.9141,379.5,230.9141,383.5,226.9141" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="48.5" x2="385.5" y1="226.9141" y2="226.9141"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="55.5" y="221.8481">generate delta files</text><polygon fill="#FF6655" points="186.5,252.0469,176.5,256.0469,186.5,260.0469,182.5,256.0469" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="379.5,252.0469,389.5,256.0469,379.5,260.0469,383.5,256.0469" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="180.5" x2="385.5" y1="256.0469" y2="256.0469"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="192.5" y="250.981">generate src hash</text><polygon fill="#FF6655" points="246,281.1797,236,285.1797,246,289.1797,242,285.1797" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="379.5,281.1797,389.5,285.1797,379.5,289.1797,383.5,285.1797" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="240" x2="385.5" y1="285.1797" y2="285.1797"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="252" y="280.1138">generate dst hash</text><polygon fill="#FF6655" points="484.5,310.3125,494.5,314.3125,484.5,318.3125,488.5,314.3125" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="391.5" x2="490.5" y1="314.3125" y2="314.3125"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="398.5" y="309.2466">generate diff</text><polygon fill="#FF6655" points="186.5,339.4453,176.5,343.4453,186.5,347.4453,182.5,343.4453" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="484.5,339.4453,494.5,343.4453,484.5,347.4453,488.5,343.4453" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="180.5" x2="490.5" y1="343.4453" y2="343.4453"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="192.5" y="338.3794">read file</text><polygon fill="#FF6655" points="246,368.5781,236,372.5781,246,376.5781,242,372.5781" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="484.5,368.5781,494.5,372.5781,484.5,376.5781,488.5,372.5781" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="240" x2="490.5" y1="372.5781" y2="372.5781"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="252" y="367.5122">read file</text><polygon fill="#FF6655" points="308,397.7109,298,401.7109,308,405.7109,304,401.7109" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="302" x2="495.5" y1="401.7109" y2="401.7109"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="314" y="396.645">write file</text><polygon fill="#FF6655" points="59.5,426.8438,49.5,430.8438,59.5,434.8438,55.5,430.8438" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="53.5" x2="390.5" y1="430.8438" y2="430.8438"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="65.5" y="425.7778">return src/dst/pch hashes</text><polygon fill="#FF6655" points="379.5,455.9766,389.5,459.9766,379.5,463.9766,383.5,459.9766" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="48.5" x2="385.5" y1="459.9766" y2="459.9766"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="55.5" y="454.9106">copy new files</text><polygon fill="#FF6655" points="246,485.1094,236,489.1094,246,493.1094,242,489.1094" style="stroke:#FF6655;stroke-width:1.0;"/><polygon fill="#FF6655" points="379.5,485.1094,389.5,489.1094,379.5,493.1094,383.5,489.1094" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="240" x2="385.5" y1="489.1094" y2="489.1094"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="252" y="484.0435">read file</text><polygon fill="#FF6655" points="308,514.2422,298,518.2422,308,522.2422,304,518.2422" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="302" x2="390.5" y1="518.2422" y2="518.2422"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="314" y="513.1763">write file</text><polygon fill="#FF6655" points="285,543.375,295,547.375,285,551.375,289,547.375" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="48.5" x2="291" y1="547.375" y2="547.375"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="55.5" y="542.3091">finalize/optimize</text><polygon fill="#FF6655" points="285,572.5078,295,576.5078,285,580.5078,289,576.5078" style="stroke:#FF6655;stroke-width:1.0;"/><line style="stroke:#FF6655;stroke-width:1.0;" x1="48.5" x2="291" y1="576.5078" y2="576.5078"/><text fill="#777777" font-family="Impact" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="55.5" y="571.4419">write manifest</text><!--MD5=[969e745e662f90b6e123db58b5c98247]
@startuml generate-sequence

skinparam interface {
  backgroundColor white
  borderColor orange
}

skinparam component {
  FontSize 13
  FontName Courier
  BorderColor black
  BackgroundColor gold
  ArrowFontName Impact
  ArrowColor #FF6655
  ArrowFontColor #777777
}

title Binary Delta Patcher Generate Command

participant PatchTool as PatchTool
participant "[src]" as src
participant "[dst]" as dst
participant "[pch]" as pch

' initialize
PatchTool -> pch : remove all files
PatchTool <-> src : parse metadata
PatchTool <-> dst : parse metadata
PatchTool -> pch : create directory structure

' multiple workers
collections XDelta3Patch as XDelta3Patch

' generate delta files
PatchTool -> XDelta3Patch : generate delta files
XDelta3Patch <-> src : generate src hash
XDelta3Patch <-> dst : generate dst hash
XDelta3Patch -> xdelta3 : generate diff
xdelta3 <-> src : read file
xdelta3 <-> dst : read file
xdelta3 -> pch : write file
XDelta3Patch -> PatchTool : return src/dst/pch hashes

' copy new files
PatchTool -> XDelta3Patch : copy new files
XDelta3Patch <-> dst : read file
XDelta3Patch -> pch : write file

' finalize
PatchTool -> pch : finalize/optimize
PatchTool -> pch : write manifest

@enduml

@startuml generate-sequence

skinparam interface {
  backgroundColor white
  borderColor orange
}

skinparam component {
  FontSize 13
  FontName Courier
  BorderColor black
  BackgroundColor gold
  ArrowFontName Impact
  ArrowColor #FF6655
  ArrowFontColor #777777
}

title Binary Delta Patcher Generate Command

participant PatchTool as PatchTool
participant "[src]" as src
participant "[dst]" as dst
participant "[pch]" as pch

PatchTool -> pch : remove all files
PatchTool <-> src : parse metadata
PatchTool <-> dst : parse metadata
PatchTool -> pch : create directory structure

collections XDelta3Patch as XDelta3Patch

PatchTool -> XDelta3Patch : generate delta files
XDelta3Patch <-> src : generate src hash
XDelta3Patch <-> dst : generate dst hash
XDelta3Patch -> xdelta3 : generate diff
xdelta3 <-> src : read file
xdelta3 <-> dst : read file
xdelta3 -> pch : write file
XDelta3Patch -> PatchTool : return src/dst/pch hashes

PatchTool -> XDelta3Patch : copy new files
XDelta3Patch <-> dst : read file
XDelta3Patch -> pch : write file

PatchTool -> pch : finalize/optimize
PatchTool -> pch : write manifest

@enduml

PlantUML version 1.2020.22(Sun Dec 06 04:36:27 EST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>